<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Google Sign-In</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .google-btn-container {
            margin: 20px 0;
            text-align: center;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Teste do Google Sign-In</h1>
        <p>Esta página testa se a configuração do Google Sign-In está funcionando corretamente.</p>
        
        <div class="status info" id="status">
            Aguardando inicialização do Google Sign-In...
        </div>
        
        <div class="google-btn-container">
            <div id="google-signin-btn"></div>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        function showResult(data) {
            const result = document.getElementById('result');
            result.innerHTML = `
                <div class="status success">
                    <h3>Login bem-sucedido!</h3>
                    <p><strong>Nome:</strong> ${data.name}</p>
                    <p><strong>Email:</strong> ${data.email}</p>
                    <p><strong>ID:</strong> ${data.sub}</p>
                    <p><strong>Token:</strong> ${data.credential.substring(0, 50)}...</p>
                </div>
            `;
        }

        function handleCredentialResponse(response) {
            try {
                // Decodifica o token JWT para obter as informações do usuário
                const payload = JSON.parse(atob(response.credential.split('.')[1]));
                
                updateStatus('Login realizado com sucesso!', 'success');
                showResult(payload);
                
                console.log('Token recebido:', response.credential);
                console.log('Dados do usuário:', payload);
                
            } catch (error) {
                updateStatus('Erro ao processar o token: ' + error.message, 'error');
                console.error('Erro:', error);
            }
        }

        function initializeGoogleSignIn() {
            if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                google.accounts.id.initialize({
                    client_id: "461681522805-dqqcv5as36rffbohlafvoof343f1bnng.apps.googleusercontent.com",
                    callback: handleCredentialResponse
                });

                const btn = document.getElementById('google-signin-btn');
                if (btn) {
                    google.accounts.id.renderButton(btn, { 
                        theme: "outline", 
                        size: "large", 
                        type: 'standard', 
                        text: 'signin_with', 
                        width: '300' 
                    });
                }
                
                updateStatus('Google Sign-In inicializado com sucesso!', 'success');
            } else {
                updateStatus('Aguardando carregamento do Google Sign-In...', 'info');
                setTimeout(initializeGoogleSignIn, 100);
            }
        }

        // Inicializa quando a página carrega
        window.onload = initializeGoogleSignIn;
    </script>
</body>
</html> 